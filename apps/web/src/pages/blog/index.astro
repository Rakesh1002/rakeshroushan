---
import Base from "@/layouts/Base.astro";
import Nav from "@/components/sections/Nav.astro";
import Footer from "@/components/sections/Footer.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("posts"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base
  title="Blog - Rakesh Roushan"
  description="Thoughts on AI, product development, and the startup journey."
>
  <Nav />
  <main class="min-h-screen pt-28 pb-24 px-6">
    <div class="mx-auto max-w-4xl">
      <a href="/" class="font-mono text-xs text-text-muted hover:text-accent transition-colors mb-8 inline-block">&larr; ~/home</a>

      <p class="font-mono text-xs text-text-muted mb-4 tracking-wide">
        <span class="text-accent">#</span> blog
      </p>
      <p class="text-text-secondary text-sm mb-16 leading-relaxed">
        Writing about building products, AI, and lessons from the startup trenches.
      </p>

      {
        posts.length > 0 ? (
          <div class="space-y-1">
            {posts.map((post) => (
              <a
                href={`/blog/${post.id}`}
                class="group block py-4 border-b border-border/50 last:border-0"
              >
                <div class="flex items-baseline justify-between gap-4 mb-1.5">
                  <h2 class="text-sm font-medium group-hover:text-accent transition-colors">
                    {post.data.title}
                  </h2>
                  <time class="text-xs text-text-muted/40 font-mono shrink-0">
                    {post.data.date.toLocaleDateString("en-US", {
                      year: "numeric",
                      month: "short",
                      day: "numeric",
                    })}
                  </time>
                </div>
                <p class="text-xs text-text-muted leading-relaxed line-clamp-1">
                  {post.data.description}
                </p>
              </a>
            ))}
          </div>
        ) : (
          <p class="text-text-muted/50 text-sm font-mono py-20 text-center">
            No posts yet. Check back soon.
          </p>
        )
      }
    </div>
  </main>
  <Footer />
</Base>
